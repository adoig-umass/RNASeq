<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=XGMkxXUZTA64h2imyzu79g);.lst-kix_3rswxags49g8-1>li:before{content:"\0025cb   "}.lst-kix_3rswxags49g8-0>li:before{content:"\0025cf   "}.lst-kix_3rswxags49g8-2>li:before{content:"\0025a0   "}.lst-kix_3rswxags49g8-3>li:before{content:"\0025cf   "}.lst-kix_3rswxags49g8-5>li:before{content:"\0025a0   "}.lst-kix_3rswxags49g8-4>li:before{content:"\0025cb   "}.lst-kix_3rswxags49g8-6>li:before{content:"\0025cf   "}.lst-kix_3rswxags49g8-8>li:before{content:"\0025a0   "}.lst-kix_uttd3u5u947g-6>li:before{content:"\0025cf   "}.lst-kix_uttd3u5u947g-8>li:before{content:"\0025a0   "}.lst-kix_3rswxags49g8-7>li:before{content:"\0025cb   "}.lst-kix_uttd3u5u947g-7>li:before{content:"\0025cb   "}.lst-kix_825hlcicvt2c-3>li:before{content:"\0025cf   "}ul.lst-kix_3rswxags49g8-7{list-style-type:none}ul.lst-kix_3rswxags49g8-8{list-style-type:none}.lst-kix_lst6xzd0gykp-2>li:before{content:"\0025a0   "}.lst-kix_825hlcicvt2c-4>li:before{content:"\0025cb   "}.lst-kix_825hlcicvt2c-5>li:before{content:"\0025a0   "}.lst-kix_uttd3u5u947g-0>li:before{content:"\0025cf   "}ul.lst-kix_3rswxags49g8-3{list-style-type:none}ul.lst-kix_3rswxags49g8-4{list-style-type:none}.lst-kix_lst6xzd0gykp-3>li:before{content:"\0025cf   "}.lst-kix_lst6xzd0gykp-4>li:before{content:"\0025cb   "}.lst-kix_825hlcicvt2c-6>li:before{content:"\0025cf   "}ul.lst-kix_3rswxags49g8-5{list-style-type:none}ul.lst-kix_3rswxags49g8-6{list-style-type:none}.lst-kix_lst6xzd0gykp-5>li:before{content:"\0025a0   "}.lst-kix_lst6xzd0gykp-6>li:before{content:"\0025cf   "}.lst-kix_825hlcicvt2c-8>li:before{content:"\0025a0   "}.lst-kix_uttd3u5u947g-4>li:before{content:"\0025cb   "}.lst-kix_825hlcicvt2c-7>li:before{content:"\0025cb   "}.lst-kix_uttd3u5u947g-5>li:before{content:"\0025a0   "}.lst-kix_1cu5hsnmltp6-5>li:before{content:"\0025a0   "}.lst-kix_lst6xzd0gykp-7>li:before{content:"\0025cb   "}.lst-kix_lst6xzd0gykp-8>li:before{content:"\0025a0   "}.lst-kix_1cu5hsnmltp6-4>li:before{content:"\0025cb   "}.lst-kix_uttd3u5u947g-3>li:before{content:"\0025cf   "}.lst-kix_81dddley45bo-6>li:before{content:"\0025cf   "}.lst-kix_1cu5hsnmltp6-3>li:before{content:"\0025cf   "}ul.lst-kix_3rswxags49g8-0{list-style-type:none}ul.lst-kix_3rswxags49g8-1{list-style-type:none}.lst-kix_uttd3u5u947g-2>li:before{content:"\0025a0   "}ul.lst-kix_3rswxags49g8-2{list-style-type:none}.lst-kix_81dddley45bo-8>li:before{content:"\0025a0   "}ul.lst-kix_2g1rl27jwb79-8{list-style-type:none}ul.lst-kix_2g1rl27jwb79-7{list-style-type:none}.lst-kix_81dddley45bo-7>li:before{content:"\0025cb   "}ul.lst-kix_2g1rl27jwb79-6{list-style-type:none}.lst-kix_1cu5hsnmltp6-2>li:before{content:"\0025a0   "}ul.lst-kix_2g1rl27jwb79-5{list-style-type:none}.lst-kix_uttd3u5u947g-1>li:before{content:"\0025cb   "}ul.lst-kix_2g1rl27jwb79-4{list-style-type:none}ul.lst-kix_2g1rl27jwb79-3{list-style-type:none}ul.lst-kix_2g1rl27jwb79-2{list-style-type:none}ul.lst-kix_2g1rl27jwb79-1{list-style-type:none}ul.lst-kix_2g1rl27jwb79-0{list-style-type:none}.lst-kix_1cu5hsnmltp6-1>li:before{content:"\0025cb   "}.lst-kix_1cu5hsnmltp6-0>li:before{content:"\0025cf   "}.lst-kix_2g1rl27jwb79-3>li:before{content:"\0025cf   "}.lst-kix_8up5818wiz47-0>li:before{content:"\0025cf   "}ul.lst-kix_lst6xzd0gykp-6{list-style-type:none}ul.lst-kix_lst6xzd0gykp-5{list-style-type:none}.lst-kix_2g1rl27jwb79-2>li:before{content:"\0025a0   "}.lst-kix_2g1rl27jwb79-4>li:before{content:"\0025cb   "}ul.lst-kix_lst6xzd0gykp-4{list-style-type:none}ul.lst-kix_lst6xzd0gykp-3{list-style-type:none}.lst-kix_2g1rl27jwb79-1>li:before{content:"\0025cb   "}.lst-kix_2g1rl27jwb79-5>li:before{content:"\0025a0   "}ul.lst-kix_lst6xzd0gykp-8{list-style-type:none}ul.lst-kix_lst6xzd0gykp-7{list-style-type:none}.lst-kix_2g1rl27jwb79-7>li:before{content:"\0025cb   "}.lst-kix_2g1rl27jwb79-0>li:before{content:"\0025cf   "}.lst-kix_2g1rl27jwb79-6>li:before{content:"\0025cf   "}.lst-kix_2g1rl27jwb79-8>li:before{content:"\0025a0   "}.lst-kix_wjp952frw1zr-2>li:before{content:"\0025a0   "}.lst-kix_wjp952frw1zr-0>li:before{content:"\0025cb   "}.lst-kix_wjp952frw1zr-3>li:before{content:"\0025cf   "}ul.lst-kix_lst6xzd0gykp-2{list-style-type:none}ul.lst-kix_lst6xzd0gykp-1{list-style-type:none}.lst-kix_wjp952frw1zr-1>li:before{content:"\0025cb   "}ul.lst-kix_lst6xzd0gykp-0{list-style-type:none}.lst-kix_vzlahrcf8wbb-8>li:before{content:"\0025a0   "}.lst-kix_wjp952frw1zr-7>li:before{content:"\0025cb   "}ul.lst-kix_1cu5hsnmltp6-6{list-style-type:none}.lst-kix_vzlahrcf8wbb-6>li:before{content:"\0025cf   "}ul.lst-kix_1cu5hsnmltp6-5{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-4{list-style-type:none}ul.lst-kix_l58p16ed4y8z-0{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-3{list-style-type:none}ul.lst-kix_l58p16ed4y8z-1{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-2{list-style-type:none}ul.lst-kix_l58p16ed4y8z-2{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-1{list-style-type:none}ul.lst-kix_l58p16ed4y8z-3{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-0{list-style-type:none}ul.lst-kix_l58p16ed4y8z-4{list-style-type:none}.lst-kix_wjp952frw1zr-5>li:before{content:"\0025a0   "}ul.lst-kix_l58p16ed4y8z-5{list-style-type:none}ul.lst-kix_uttd3u5u947g-1{list-style-type:none}.lst-kix_vzlahrcf8wbb-2>li:before{content:"\0025a0   "}ul.lst-kix_l58p16ed4y8z-6{list-style-type:none}ul.lst-kix_uttd3u5u947g-2{list-style-type:none}ul.lst-kix_l58p16ed4y8z-7{list-style-type:none}ul.lst-kix_uttd3u5u947g-3{list-style-type:none}ul.lst-kix_l58p16ed4y8z-8{list-style-type:none}ul.lst-kix_uttd3u5u947g-4{list-style-type:none}.lst-kix_vzlahrcf8wbb-0>li:before{content:"\0025cf   "}.lst-kix_vzlahrcf8wbb-4>li:before{content:"\0025cb   "}ul.lst-kix_1cu5hsnmltp6-8{list-style-type:none}ul.lst-kix_1cu5hsnmltp6-7{list-style-type:none}ul.lst-kix_uttd3u5u947g-0{list-style-type:none}.lst-kix_3wtq89kccgvo-0>li:before{content:"\0025cb   "}.lst-kix_3wtq89kccgvo-4>li:before{content:"\0025cb   "}.lst-kix_8up5818wiz47-1>li:before{content:"\0025cb   "}.lst-kix_3wtq89kccgvo-2>li:before{content:"\0025a0   "}.lst-kix_8up5818wiz47-3>li:before{content:"\0025cf   "}.lst-kix_3wtq89kccgvo-8>li:before{content:"\0025a0   "}ul.lst-kix_uttd3u5u947g-5{list-style-type:none}ul.lst-kix_uttd3u5u947g-6{list-style-type:none}.lst-kix_l58p16ed4y8z-5>li:before{content:"\0025a0   "}.lst-kix_8up5818wiz47-5>li:before{content:"\0025a0   "}ul.lst-kix_uttd3u5u947g-7{list-style-type:none}ul.lst-kix_uttd3u5u947g-8{list-style-type:none}.lst-kix_3wtq89kccgvo-6>li:before{content:"\0025cf   "}.lst-kix_l58p16ed4y8z-7>li:before{content:"\0025cb   "}.lst-kix_8up5818wiz47-7>li:before{content:"\0025cb   "}.lst-kix_81dddley45bo-2>li:before{content:"\0025a0   "}.lst-kix_i85481pql9wb-2>li:before{content:"\0025a0   "}.lst-kix_i85481pql9wb-6>li:before{content:"\0025cf   "}.lst-kix_81dddley45bo-4>li:before{content:"\0025cb   "}.lst-kix_i85481pql9wb-4>li:before{content:"\0025cb   "}.lst-kix_1cu5hsnmltp6-7>li:before{content:"\0025cb   "}.lst-kix_d2r9w542k1jm-0>li:before{content:"\0025cf   "}.lst-kix_d2r9w542k1jm-2>li:before{content:"\0025a0   "}.lst-kix_81dddley45bo-0>li:before{content:"\0025cf   "}.lst-kix_i85481pql9wb-0>li:before{content:"\0025cf   "}.lst-kix_lst6xzd0gykp-1>li:before{content:"\0025cb   "}.lst-kix_d2r9w542k1jm-8>li:before{content:"\0025a0   "}.lst-kix_825hlcicvt2c-2>li:before{content:"\0025a0   "}.lst-kix_825hlcicvt2c-0>li:before{content:"\0025cf   "}.lst-kix_d2r9w542k1jm-4>li:before{content:"\0025cb   "}.lst-kix_j55y6eh3yxof-0>li:before{content:"\0025cb   "}ul.lst-kix_81dddley45bo-8{list-style-type:none}ul.lst-kix_81dddley45bo-7{list-style-type:none}ul.lst-kix_81dddley45bo-6{list-style-type:none}ul.lst-kix_81dddley45bo-5{list-style-type:none}ul.lst-kix_81dddley45bo-4{list-style-type:none}ul.lst-kix_81dddley45bo-3{list-style-type:none}.lst-kix_d2r9w542k1jm-6>li:before{content:"\0025cf   "}ul.lst-kix_81dddley45bo-2{list-style-type:none}ul.lst-kix_81dddley45bo-1{list-style-type:none}.lst-kix_i85481pql9wb-8>li:before{content:"\0025a0   "}ul.lst-kix_81dddley45bo-0{list-style-type:none}.lst-kix_auqmcxp7c21w-2>li:before{content:"\0025a0   "}.lst-kix_auqmcxp7c21w-3>li:before{content:"\0025cf   "}.lst-kix_j55y6eh3yxof-8>li:before{content:"\0025a0   "}.lst-kix_j55y6eh3yxof-7>li:before{content:"\0025cb   "}ul.lst-kix_825hlcicvt2c-5{list-style-type:none}.lst-kix_auqmcxp7c21w-6>li:before{content:"\0025cf   "}ul.lst-kix_825hlcicvt2c-4{list-style-type:none}ul.lst-kix_j55y6eh3yxof-0{list-style-type:none}ul.lst-kix_825hlcicvt2c-7{list-style-type:none}ul.lst-kix_j55y6eh3yxof-1{list-style-type:none}ul.lst-kix_825hlcicvt2c-6{list-style-type:none}.lst-kix_auqmcxp7c21w-4>li:before{content:"\0025cb   "}.lst-kix_auqmcxp7c21w-5>li:before{content:"\0025a0   "}ul.lst-kix_825hlcicvt2c-8{list-style-type:none}ul.lst-kix_i85481pql9wb-1{list-style-type:none}ul.lst-kix_i85481pql9wb-2{list-style-type:none}ul.lst-kix_i85481pql9wb-3{list-style-type:none}ul.lst-kix_i85481pql9wb-4{list-style-type:none}.lst-kix_j55y6eh3yxof-2>li:before{content:"\0025a0   "}ul.lst-kix_i85481pql9wb-5{list-style-type:none}ul.lst-kix_825hlcicvt2c-1{list-style-type:none}ul.lst-kix_i85481pql9wb-6{list-style-type:none}ul.lst-kix_825hlcicvt2c-0{list-style-type:none}ul.lst-kix_i85481pql9wb-7{list-style-type:none}ul.lst-kix_825hlcicvt2c-3{list-style-type:none}ul.lst-kix_i85481pql9wb-8{list-style-type:none}.lst-kix_j55y6eh3yxof-3>li:before{content:"\0025cf   "}ul.lst-kix_825hlcicvt2c-2{list-style-type:none}.lst-kix_j55y6eh3yxof-4>li:before{content:"\0025cb   "}.lst-kix_j55y6eh3yxof-6>li:before{content:"\0025cf   "}.lst-kix_auqmcxp7c21w-0>li:before{content:"\0025cf   "}.lst-kix_auqmcxp7c21w-1>li:before{content:"\0025cb   "}.lst-kix_j55y6eh3yxof-5>li:before{content:"\0025a0   "}ul.lst-kix_vzlahrcf8wbb-8{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-7{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-6{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-5{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-4{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-3{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-2{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-1{list-style-type:none}ul.lst-kix_vzlahrcf8wbb-0{list-style-type:none}.lst-kix_auqmcxp7c21w-7>li:before{content:"\0025cb   "}.lst-kix_auqmcxp7c21w-8>li:before{content:"\0025a0   "}.lst-kix_l58p16ed4y8z-3>li:before{content:"\0025cf   "}.lst-kix_l58p16ed4y8z-2>li:before{content:"\0025a0   "}.lst-kix_l58p16ed4y8z-0>li:before{content:"\0025cf   "}.lst-kix_l58p16ed4y8z-1>li:before{content:"\0025cb   "}ul.lst-kix_i85481pql9wb-0{list-style-type:none}ul.lst-kix_d2r9w542k1jm-6{list-style-type:none}ul.lst-kix_d2r9w542k1jm-5{list-style-type:none}ul.lst-kix_d2r9w542k1jm-4{list-style-type:none}ul.lst-kix_d2r9w542k1jm-3{list-style-type:none}.lst-kix_wjp952frw1zr-8>li:before{content:"\0025a0   "}ul.lst-kix_d2r9w542k1jm-2{list-style-type:none}ul.lst-kix_d2r9w542k1jm-1{list-style-type:none}ul.lst-kix_d2r9w542k1jm-0{list-style-type:none}.lst-kix_vzlahrcf8wbb-5>li:before{content:"\0025a0   "}.lst-kix_vzlahrcf8wbb-7>li:before{content:"\0025cb   "}.lst-kix_wjp952frw1zr-4>li:before{content:"\0025cb   "}.lst-kix_wjp952frw1zr-6>li:before{content:"\0025cf   "}.lst-kix_vzlahrcf8wbb-1>li:before{content:"\0025cb   "}.lst-kix_vzlahrcf8wbb-3>li:before{content:"\0025cf   "}.lst-kix_3wtq89kccgvo-3>li:before{content:"\0025cf   "}.lst-kix_3wtq89kccgvo-5>li:before{content:"\0025a0   "}.lst-kix_3wtq89kccgvo-1>li:before{content:"\0025cb   "}.lst-kix_8up5818wiz47-2>li:before{content:"\0025a0   "}ul.lst-kix_3wtq89kccgvo-0{list-style-type:none}ul.lst-kix_3wtq89kccgvo-1{list-style-type:none}.lst-kix_8up5818wiz47-4>li:before{content:"\0025cb   "}ul.lst-kix_3wtq89kccgvo-2{list-style-type:none}ul.lst-kix_3wtq89kccgvo-3{list-style-type:none}ul.lst-kix_3wtq89kccgvo-4{list-style-type:none}ul.lst-kix_3wtq89kccgvo-5{list-style-type:none}.lst-kix_3wtq89kccgvo-7>li:before{content:"\0025cb   "}.lst-kix_l58p16ed4y8z-4>li:before{content:"\0025cb   "}ul.lst-kix_3wtq89kccgvo-6{list-style-type:none}ul.lst-kix_3wtq89kccgvo-7{list-style-type:none}ul.lst-kix_3wtq89kccgvo-8{list-style-type:none}.lst-kix_l58p16ed4y8z-6>li:before{content:"\0025cf   "}.lst-kix_8up5818wiz47-8>li:before{content:"\0025a0   "}ul.lst-kix_wjp952frw1zr-4{list-style-type:none}ul.lst-kix_auqmcxp7c21w-3{list-style-type:none}ul.lst-kix_wjp952frw1zr-5{list-style-type:none}ul.lst-kix_auqmcxp7c21w-2{list-style-type:none}ul.lst-kix_wjp952frw1zr-2{list-style-type:none}ul.lst-kix_auqmcxp7c21w-1{list-style-type:none}ul.lst-kix_wjp952frw1zr-3{list-style-type:none}ul.lst-kix_auqmcxp7c21w-0{list-style-type:none}.lst-kix_8up5818wiz47-6>li:before{content:"\0025cf   "}ul.lst-kix_wjp952frw1zr-8{list-style-type:none}ul.lst-kix_auqmcxp7c21w-7{list-style-type:none}ul.lst-kix_auqmcxp7c21w-6{list-style-type:none}ul.lst-kix_wjp952frw1zr-6{list-style-type:none}ul.lst-kix_auqmcxp7c21w-5{list-style-type:none}ul.lst-kix_wjp952frw1zr-7{list-style-type:none}ul.lst-kix_auqmcxp7c21w-4{list-style-type:none}ul.lst-kix_auqmcxp7c21w-8{list-style-type:none}.lst-kix_l58p16ed4y8z-8>li:before{content:"\0025a0   "}ul.lst-kix_wjp952frw1zr-0{list-style-type:none}ul.lst-kix_wjp952frw1zr-1{list-style-type:none}.lst-kix_81dddley45bo-1>li:before{content:"\0025cb   "}.lst-kix_81dddley45bo-5>li:before{content:"\0025a0   "}.lst-kix_i85481pql9wb-3>li:before{content:"\0025cf   "}.lst-kix_81dddley45bo-3>li:before{content:"\0025cf   "}.lst-kix_i85481pql9wb-5>li:before{content:"\0025a0   "}.lst-kix_1cu5hsnmltp6-6>li:before{content:"\0025cf   "}.lst-kix_d2r9w542k1jm-1>li:before{content:"\0025cb   "}.lst-kix_1cu5hsnmltp6-8>li:before{content:"\0025a0   "}.lst-kix_i85481pql9wb-1>li:before{content:"\0025cb   "}.lst-kix_lst6xzd0gykp-0>li:before{content:"\0025cf   "}ul.lst-kix_8up5818wiz47-0{list-style-type:none}.lst-kix_d2r9w542k1jm-5>li:before{content:"\0025a0   "}.lst-kix_825hlcicvt2c-1>li:before{content:"\0025cb   "}ul.lst-kix_8up5818wiz47-2{list-style-type:none}ul.lst-kix_8up5818wiz47-1{list-style-type:none}.lst-kix_d2r9w542k1jm-3>li:before{content:"\0025cf   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_j55y6eh3yxof-1>li:before{content:"\0025cb   "}ul.lst-kix_8up5818wiz47-8{list-style-type:none}ul.lst-kix_j55y6eh3yxof-6{list-style-type:none}ul.lst-kix_8up5818wiz47-7{list-style-type:none}ul.lst-kix_j55y6eh3yxof-7{list-style-type:none}ul.lst-kix_j55y6eh3yxof-8{list-style-type:none}ul.lst-kix_8up5818wiz47-4{list-style-type:none}ul.lst-kix_j55y6eh3yxof-2{list-style-type:none}ul.lst-kix_8up5818wiz47-3{list-style-type:none}ul.lst-kix_j55y6eh3yxof-3{list-style-type:none}ul.lst-kix_8up5818wiz47-6{list-style-type:none}.lst-kix_i85481pql9wb-7>li:before{content:"\0025cb   "}ul.lst-kix_j55y6eh3yxof-4{list-style-type:none}ul.lst-kix_8up5818wiz47-5{list-style-type:none}ul.lst-kix_j55y6eh3yxof-5{list-style-type:none}.lst-kix_d2r9w542k1jm-7>li:before{content:"\0025cb   "}ul.lst-kix_d2r9w542k1jm-8{list-style-type:none}ul.lst-kix_d2r9w542k1jm-7{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c15{-webkit-text-decoration-skip:none;color:#000000;font-weight:700;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:11pt;font-family:"Arial";font-style:normal}.c1{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c10{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c9{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c8{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c20{-webkit-text-decoration-skip:none;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-family:"Arial";font-style:normal}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c5{font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c16{padding-top:0pt;padding-bottom:0pt;line-height:1.4;orphans:2;widows:2;text-align:left}.c24{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c12{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c27{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;font-weight:700;text-decoration:underline}.c22{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c17{padding:0;margin:0}.c23{margin-left:72pt;padding-left:0pt}.c25{color:inherit;text-decoration:inherit}.c11{font-family:"Roboto Mono";font-weight:400}.c21{margin-left:36pt;text-indent:-18pt}.c2{color:#188038}.c13{color:#404040}.c7{height:11pt}.c19{color:#000000}.c0{color:#ffffff}.c26{font-size:8.5pt}.c14{color:#434343}.c18{font-size:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c22 doc-content"><ul class="c17 lst-kix_825hlcicvt2c-0 start"><li class="c1 li-bullet-0"><span class="c3">Navigate to Home Directory</span></li></ul><p class="c4"><span>&#60419;</span><span class="c2">cd</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M</span></p><h2 class="c9" id="h.u0bc67sl1uum"><span class="c18">&#60418;</span><span class="c15">FastQC</span></h2><ul class="c17 lst-kix_d2r9w542k1jm-0 start"><li class="c1 li-bullet-0"><span class="c3">Run for all lanes/rows of each sample </span></li></ul><p class="c4 c7"><span class="c3"></span></p><p class="c4 c21"><span>&#60419;</span><span class="c2">module</span><span>&nbsp;</span><span class="c2">load</span><span>&nbsp;</span><span class="c5 c2">fastqc/0.11.9</span></p><p class="c4 c21"><span class="c5 c2">fastqc *.fastq.gz</span></p><p class="c4"><span class="c3">&#60418;</span></p><ul class="c17 lst-kix_lst6xzd0gykp-0 start"><li class="c1 li-bullet-0"><span class="c3">Based on the FastQC reports, fastq_batch1 are good quality reads and will be aligned </span></li><li class="c1 li-bullet-0"><span class="c3">Fastq_batch2 files need to have adapters trimmed</span></li><li class="c1 li-bullet-0"><span class="c3">Will trim adapter sequences using FastP</span></li></ul><h2 class="c9" id="h.pknmsxjyhefv"><span class="c18 c27">FastP</span></h2><p class="c4"><span>&#60419;</span><span class="c5 c2">module load uri/main</span></p><p class="c4"><span class="c5 c2">module load fastp/0.23.2-GCC-11.2.0</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">fastp -i 1C-New-TGACCA_S4_L004_R1_001.fastq.gz -I 1C-New-TGACCA_S4_L004_R2_001.fastq.gz -o trimmed1C-New-TGACCA_S4_L004_R1.fastq.gz -O trimmed1C-New-TGACCA_S4_L004_R2.fastq.gz --detect_adapter_for_pe</span></p><h2 class="c9" id="h.v7622zalhz0b"><span class="c18">&#60418;</span><span class="c15">STAR</span></h2><h3 class="c8" id="h.vwdtv4q31r6m"><span class="c20 c14 c18">Create an Index File</span></h3><p class="c4"><span>&#60419;</span><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c2">star/2.7.10b</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">cd</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">STAR</span><span class="c0">&nbsp;</span><span class="c2">--runThreadN</span><span class="c0">&nbsp;</span><span class="c2">7</span><span class="c0">&nbsp;</span><span class="c2">--runMode</span><span class="c0">&nbsp;</span><span class="c2">genomeGenerate</span><span class="c0">&nbsp;</span><span class="c2">--genomeDir</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Index</span><span class="c0">&nbsp;</span><span class="c2">--genomeFastaFiles</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Homo_sapiens.GRCh38.dna_sm.toplevel.fa</span><span class="c0">&nbsp;</span><span class="c2">--sjdbGTFfile</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Homo_sapiens.GRCh38.111.gtf</span><span class="c0">&nbsp;</span><span class="c2">--sjdbOverhang</span><span class="c0">&nbsp;</span><span class="c5 c2">100</span></p><h3 class="c8" id="h.nhqkd1dmrr6r"><span class="c18">&#60418;</span><span class="c14 c18 c20">Align Reads</span></h3><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span><span class="c3">&nbsp;</span></p><p class="c4"><span class="c5 c2">#SBATCH --job-name=19C-55431414_Align</span></p><p class="c4"><span class="c5 c2">#SBATCH -c 16</span></p><p class="c4"><span class="c5 c2">#SBATCH -n 1</span></p><p class="c4"><span class="c5 c2">#SBATCH --mem-per-cpu=30G</span></p><p class="c4"><span class="c5 c2">#SBATCH -p cpu-long</span></p><p class="c4"><span class="c5 c2">#SBATCH --time=24:00:00</span></p><p class="c4"><span class="c5 c2">#SBATCH --output=19C-55431414_Align.out</span></p><p class="c4"><span class="c5 c2">#SBATCH --error=19C-55431414_Align.err</span></p><p class="c4"><span class="c5 c2">#SBATCH --mail-type=END</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c5 c2">star/2.7.10b</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">cd /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/19C-55431414</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">STAR --genomeDir /work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Index \</span></p><p class="c4"><span class="c5 c2">--runThreadN 16 \</span></p><p class="c4"><span class="c5 c2">--readFilesCommand zcat \</span></p><p class="c4"><span class="c5 c2">--readFilesIn 19C_S7_L001_R1_001.fastq.gz,19C_S7_L002_R1_001.fastq.gz,19C_S7_L003_R1_001.fastq.gz,19C_S7_L004_R1_001.fastq.gz 19C_S7_L001_R2_001.fastq.gz,19C_S7_L002_R2_001.fastq.gz,19C_S7_L003_R2_001.fastq.gz,19C_S7_L004_R2_001.fastq.gz \</span></p><p class="c4"><span class="c5 c2">--outFileNamePrefix /work/pi_cpak_umass_edu/Hinderhofer_M/Results/ \</span></p><p class="c4"><span class="c5 c2">--outSAMtype BAM SortedByCoordinate \</span></p><p class="c4"><span class="c5 c2">--outSAMunmapped Within \</span></p><p class="c4"><span class="c5 c2">--outSAMattributes Standard</span></p><p class="c4"><span class="c2">--quantMode</span><span class="c0">&nbsp;</span><span class="c2">TranscriptomeSAM</span><span class="c0">&nbsp;</span><span class="c5 c2">GeneCounts</span></p><ul class="c17 lst-kix_auqmcxp7c21w-0 start"><li class="c1 li-bullet-0"><span class="c3">&#60418;Repeat for each condition changing necessary parameters in fastq_batch1</span></li></ul><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--job-name=1C-New-TGACCA_S4_Align</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-c</span><span class="c0">&nbsp;</span><span class="c2">16</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-n</span><span class="c0">&nbsp;</span><span class="c2">1</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mem-per-cpu=10G</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-p</span><span class="c0">&nbsp;</span><span class="c2">cpu-long</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--time=24:00:00</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--output=1C-New-TGACCA_S4.out</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--error=1C-New-TGACCA_S4.err</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mail-type=END</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c2">star/2.7.10b</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">cd</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/1C-New-TGACCA_S4</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">STAR</span><span class="c0">&nbsp;</span><span class="c2">--genomeDir</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Index</span><span class="c0">&nbsp;</span><span class="c2">--runThreadN</span><span class="c0">&nbsp;</span><span class="c2">16</span><span class="c0">&nbsp;</span><span class="c2">--readFilesCommand</span><span class="c0">&nbsp;</span><span class="c2">zcat</span><span class="c0">&nbsp;</span><span class="c2">--readFilesIn</span><span class="c0">&nbsp;</span><span class="c2">trimmed1C-New-TGACCA_S4_L004_R1.fastq.gz,trimmed1C-New-TGACCA_S4_L005_R1.fastq.gz</span><span class="c0">&nbsp;</span><span class="c2">trimmed1C-New-TGACCA_S4_L004_R2.fastq.gz,trimmed1C-New-TGACCA_S4_L005_R2.fastq.gz</span><span class="c0">&nbsp;</span><span class="c2">--outFileNamePrefix</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/1C-New-TGACCA_S4/Results/1C-New-TGACCA_S4_</span><span class="c0">&nbsp;</span><span class="c2">--outSAMtype</span><span class="c0">&nbsp;</span><span class="c2">BAM</span><span class="c0">&nbsp;</span><span class="c2">SortedByCoordinate</span><span class="c0">&nbsp;</span><span class="c2">--outSAMunmapped</span><span class="c0">&nbsp;</span><span class="c2">Within</span><span class="c0">&nbsp;</span><span class="c2">--outSAMattributes</span><span class="c0">&nbsp;</span><span class="c2">Standard</span><span class="c0">&nbsp;</span><span class="c2">--quantMode</span><span class="c0">&nbsp;</span><span class="c2">TranscriptomeSAM</span><span class="c0">&nbsp;</span><span class="c5 c2">GeneCounts</span></p><p class="c4 c7"><span class="c5 c2"></span></p><h3 class="c8" id="h.o2wve1xh5zvu"><span class="c5 c14">&#60418;Indexing Reads</span></h3><ul class="c17 lst-kix_2g1rl27jwb79-0 start"><li class="c1 li-bullet-0"><span class="c3">Index both batch 1 and 2 (.bam.bai) </span></li></ul><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--job-name=baiFileMaker2</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-c</span><span>&nbsp;</span><span class="c2">16</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-n</span><span>&nbsp;</span><span class="c2">1</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--mem-per-cpu=30G</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-p</span><span>&nbsp;</span><span class="c2">cpu-long</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--time=12:00:00</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--output=baiFileMaker2%j.out</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--error=baiFileMaker2%j.err</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--mail-type=END</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">module</span><span>&nbsp;</span><span class="c2">load</span><span>&nbsp;</span><span class="c2">samtools/1.14+py3.8.12</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">#</span><span>&nbsp;</span><span class="c2">List</span><span>&nbsp;</span><span class="c2">of</span><span>&nbsp;</span><span class="c2">sample</span><span>&nbsp;</span><span class="c2">IDs</span><span>&nbsp;</span><span class="c2">for</span><span>&nbsp;</span><span class="c2">batch</span><span>&nbsp;</span><span class="c2">2</span></p><p class="c4"><span class="c2">samples=(&quot;1C-New-TGACCA_S4&quot;</span><span>&nbsp;</span><span class="c2">&quot;2C-New-ACAGTG_S5&quot;</span><span>&nbsp;</span><span class="c2">&quot;3C-New-GCCAAT_S6&quot;</span><span>&nbsp;</span><span class="c2">&quot;C1-Old-CAGATC_S7&quot;</span><span>&nbsp;</span><span class="c2">&quot;C3-Old-GATCAG_S9&quot;</span></p><p class="c4"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">&quot;N2-Old-GGCTAC_S11&quot;</span><span>&nbsp;</span><span class="c2">&quot;1F-New-ATCACG_S1&quot;</span><span>&nbsp;</span><span class="c2">&quot;2F-New-CGATGT_S2&quot;</span><span>&nbsp;</span><span class="c2">&quot;3F-New-TTAGGC_S3&quot;</span><span>&nbsp;</span><span class="c2">&quot;C2-Old-ACTTGA_S8&quot;</span></p><p class="c4"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">&quot;N1-Old-TAGCTT_S10&quot;</span><span>&nbsp;</span><span class="c2">&quot;N3-Old-CTTGTA_S12&quot;)</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">#</span><span>&nbsp;</span><span class="c2">Base</span><span>&nbsp;</span><span class="c2">directory</span><span>&nbsp;</span><span class="c2">path</span><span>&nbsp;</span><span class="c2">for</span><span>&nbsp;</span><span class="c2">batch</span><span>&nbsp;</span><span class="c2">2</span></p><p class="c4"><span class="c2">base_dir=&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2&quot;</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">#</span><span>&nbsp;</span><span class="c2">Loop</span><span>&nbsp;</span><span class="c2">through</span><span>&nbsp;</span><span class="c2">each</span><span>&nbsp;</span><span class="c2">sample</span><span>&nbsp;</span><span class="c2">and</span><span>&nbsp;</span><span class="c2">index</span><span>&nbsp;</span><span class="c2">the</span><span>&nbsp;</span><span class="c2">BAM</span><span>&nbsp;</span><span class="c2">file</span></p><p class="c4"><span class="c2">for</span><span>&nbsp;</span><span class="c2">sample</span><span>&nbsp;</span><span class="c2">in</span><span>&nbsp;</span><span class="c2">&quot;${samples[@]}&quot;</span></p><p class="c4"><span class="c2">do</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">bam_file=&quot;${base_dir}/${sample}/Results/${sample}_Aligned.sortedByCoord.out.bam&quot;</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">echo</span><span>&nbsp;</span><span class="c2">&quot;Indexing</span><span>&nbsp;</span><span class="c2">$bam_file&quot;</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">samtools</span><span>&nbsp;</span><span class="c2">index</span><span>&nbsp;</span><span class="c2">&quot;$bam_file&quot;</span></p><p class="c4"><span class="c2">done</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">echo</span><span>&nbsp;</span><span class="c2">&quot;Indexing</span><span>&nbsp;</span><span class="c2">complete</span><span>&nbsp;</span><span class="c2">for</span><span>&nbsp;</span><span class="c2">all</span><span>&nbsp;</span><span class="c2">samples</span><span>&nbsp;</span><span class="c2">in</span><span>&nbsp;</span><span class="c2">batch</span><span>&nbsp;</span><span class="c2">two.&quot;</span></p><h2 class="c9" id="h.4lbzxju4kvlv"><span>&#60418;</span><span class="c3">RSEM</span></h2><h3 class="c8" id="h.wei0hespr23h"><span class="c5 c14">Create Reference File </span></h3><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--job-name=Rsem_Index</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-c</span><span class="c0">&nbsp;</span><span class="c2">16</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-n</span><span class="c0">&nbsp;</span><span class="c2">1</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mem=40G</span><span class="c5 c0">&nbsp; </span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-p</span><span class="c0">&nbsp;</span><span class="c2">cpu-long</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--time=24:00:00</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--output=Rsem_Index.out</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--error=Rsem_Index.err</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mail-type=END</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c2">rsem/1.3.3</span></p><p class="c4"><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c2">star/2.7.10b</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">cd</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">rsem-prepare-reference</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c2">--gtf</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Homo_sapiens.GRCh38.111.gtf</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c2">--star</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Homo_sapiens.GRCh38.dna_sm.toplevel.fa</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome/rsem_reference</span></p><p class="c4 c7"><span class="c5 c2"></span></p><h3 class="c8" id="h.q9usmqgb3b1w"><span>&#60418;</span><span class="c18">Calculate Expression in RSEM</span></h3><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--job-name=RSEM_Calculation</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-c</span><span class="c0">&nbsp;</span><span class="c2">16</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-n</span><span class="c0">&nbsp;</span><span class="c2">1</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mem-per-cpu=30G</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">-p</span><span class="c0">&nbsp;</span><span class="c2">cpu-long</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--time=48:00:00</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--output=RSEM_Calculation_%j.out</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--error=RSEM_Calculation_%j.err</span></p><p class="c4"><span class="c2">#SBATCH</span><span class="c0">&nbsp;</span><span class="c2">--mail-type=END</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">module</span><span class="c0">&nbsp;</span><span class="c2">load</span><span class="c0">&nbsp;</span><span class="c2">rsem/1.3.3</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Directory</span><span class="c0">&nbsp;</span><span class="c2">with</span><span class="c0">&nbsp;</span><span class="c2">all</span><span class="c0">&nbsp;</span><span class="c2">the</span><span class="c0">&nbsp;</span><span class="c2">samples</span></p><p class="c4"><span class="c2">cd</span><span class="c0">&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Array</span><span class="c0">&nbsp;</span><span class="c2">of</span><span class="c0">&nbsp;</span><span class="c2">sample</span><span class="c0">&nbsp;</span><span class="c2">IDs</span></p><p class="c4"><span class="c2">samples=(19C_S7</span><span class="c0">&nbsp;</span><span class="c2">26C_S4</span><span class="c0">&nbsp;</span><span class="c2">C2463-19_S6</span><span class="c0">&nbsp;</span><span class="c2">C3141-4_S5</span><span class="c0">&nbsp;</span><span class="c2">N3320-23_S10</span><span class="c0">&nbsp;</span><span class="c2">N3320-7_S11</span><span class="c0">&nbsp;</span><span class="c2">19N_S2</span><span class="c0">&nbsp;</span><span class="c2">26N_S3</span><span class="c0">&nbsp;</span><span class="c2">C3141-23_S12</span><span class="c0">&nbsp;</span><span class="c2">C3141-7_S1</span><span class="c0">&nbsp;</span><span class="c2">N3320-4_S9</span><span class="c0">&nbsp;</span><span class="c2">N9540-19_S8)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Loop</span><span class="c0">&nbsp;</span><span class="c2">through</span><span class="c0">&nbsp;</span><span class="c2">each</span><span class="c0">&nbsp;</span><span class="c2">sample</span></p><p class="c4"><span class="c2">for</span><span class="c0">&nbsp;</span><span class="c2">sample</span><span class="c0">&nbsp;</span><span class="c2">in</span><span class="c0">&nbsp;</span><span class="c2">&quot;${samples[@]}&quot;</span></p><p class="c4"><span class="c2">do</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">echo</span><span class="c0">&nbsp;</span><span class="c2">&quot;Processing</span><span class="c0">&nbsp;</span><span class="c2">$sample&quot;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">rsem-calculate-expression</span><span class="c0">&nbsp;</span><span class="c2">--bam</span><span class="c0">&nbsp;</span><span class="c2">--paired-end</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">--estimate-rspd</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">--append-names</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">--output-genome-bam</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">-p</span><span class="c0">&nbsp;</span><span class="c2">16</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/$sample/Results/${sample}_Aligned.toTranscriptome.out.bam</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">rsem_reference</span><span class="c0">&nbsp;</span><span class="c2">\</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/$sample/Results/${sample}_rsem</span></p><p class="c4"><span class="c2">done</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c3">&#60418;</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span>&#60419;</span><span class="c2">#!/bin/bash</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--job-name=RSEM_Calculation_batch2</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-c</span><span>&nbsp;</span><span class="c2">16</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-n</span><span>&nbsp;</span><span class="c2">1</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--mem-per-cpu=30G</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">-p</span><span>&nbsp;</span><span class="c2">cpu-long</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--time=48:00:00</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--output=RSEM_Calculation_batch2%j.out</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--error=RSEM_Calculation_batch2%j.err</span></p><p class="c4"><span class="c2">#SBATCH</span><span>&nbsp;</span><span class="c2">--mail-type=END</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">module</span><span>&nbsp;</span><span class="c2">load</span><span>&nbsp;</span><span class="c2">rsem/1.3.3</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">cd</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Genome</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">samples=(1C-New-TGACCA_S4</span><span>&nbsp;</span><span class="c2">2C-New-ACAGTG_S5</span><span>&nbsp;</span><span class="c2">3C-New-GCCAAT_S6</span><span>&nbsp;</span><span class="c2">C1-Old-CAGATC_S7</span><span>&nbsp;</span><span class="c2">C3-Old-GATCAG_S9</span><span>&nbsp;</span><span class="c2">N2-Old-GGCTAC_S11</span><span>&nbsp;</span><span class="c2">1F-New-ATCACG_S1</span><span>&nbsp;</span><span class="c2">2F-New-CGATGT_S2</span><span>&nbsp;</span><span class="c2">3F-New-TTAGGC_S3</span><span>&nbsp;</span><span class="c2">C2-Old-ACTTGA_S8</span><span>&nbsp;</span><span class="c2">N1-Old-TAGCTT_S10</span><span>&nbsp;</span><span class="c2">N3-Old-CTTGTA_S12)</span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c2">for</span><span>&nbsp;</span><span class="c2">sample</span><span>&nbsp;</span><span class="c2">in</span><span>&nbsp;</span><span class="c2">&quot;${samples[@]}&quot;</span></p><p class="c4"><span class="c2">do</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">echo</span><span>&nbsp;</span><span class="c2">&quot;Processing</span><span>&nbsp;</span><span class="c2">$sample</span><span>&nbsp;</span><span class="c2">from</span><span>&nbsp;</span><span class="c2">batch</span><span>&nbsp;</span><span class="c2">2&quot;</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">rsem-calculate-expression</span><span>&nbsp;</span><span class="c2">--bam</span><span>&nbsp;</span><span class="c2">--paired-end</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">--estimate-rspd</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">--append-names</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">--output-genome-bam</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">-p</span><span>&nbsp;</span><span class="c2">16</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/$sample/Results/${sample}_Aligned.toTranscriptome.out.bam</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">rsem_reference</span><span>&nbsp;</span><span class="c2">\</span></p><p class="c4"><span>&nbsp; &nbsp; </span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/$sample/Results/${sample}_rsem</span></p><p class="c4"><span class="c2">done</span></p><h2 class="c9" id="h.ahgl5q797756"><span class="c3">&#60418;DESeq2</span></h2><h3 class="c8" id="h.gapc5sfszap0"><span class="c18">rsem.genes.results</span></h3><p class="c4"><span>&#60419;</span><span class="c2">```{r}</span></p><p class="c4"><span class="c2">setwd(&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data&quot;)</span></p><p class="c4"><span class="c2">library(DESeq2)</span></p><p class="c4"><span class="c2">library(tximport)</span></p><p class="c4"><span class="c2">library(openxlsx)</span></p><p class="c4"><span class="c2">library(readr)</span></p><p class="c4"><span class="c2">library(pheatmap)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">Batch1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;C3141-7_S1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;19N_S2&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;26N_S3&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;26C_S4&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C3141-4_S5&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C2463-19_S6&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;19C_S7&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N9540-19_S8&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3320-4_S9&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N3320-23_S10&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3320-7_S11&quot;,&quot;C3141-23_S12&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">Batch2</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;1F-New-ATCACG_S1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;2F-New-CGATGT_S2&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;3F-New-TTAGGC_S3&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1C-New-TGACCA_S4&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;2C-New-ACAGTG_S5&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;3C-New-GCCAAT_S6&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C1-Old-CAGATC_S7&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C2-Old-ACTTGA_S8&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C3-Old-GATCAG_S9&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N1-Old-TAGCTT_S10&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N2-Old-GGCTAC_S11&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3-Old-CTTGTA_S12&quot;)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">SampleRefID</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">read.csv(&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data/batch1_2fileID.csv&quot;,</span><span class="c0">&nbsp;</span><span class="c2">header</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">F)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">KO_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;N3320-23_S10&quot;,&quot;N3320-4_S9&quot;,&quot;N3320-7_S11&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;26N_S3&quot;,&quot;N9540-19_S8&quot;,&quot;19N_S2&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N1-Old-TAGCTT_S10&quot;,&quot;N2-Old-GGCTAC_S11&quot;,&quot;N3-Old-CTTGTA_S12&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1C-New-TGACCA_S4&quot;,&quot;2C-New-ACAGTG_S5&quot;,&quot;3C-New-GCCAAT_S6&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">WT_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;26C_S4&quot;,&quot;C2463-19_S6&quot;,&quot;19C_S7&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C3141-23_S12&quot;,&quot;C3141-4_S5&quot;,&quot;C3141-7_S1&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C1-Old-CAGATC_S7&quot;,&quot;C2-Old-ACTTGA_S8&quot;,&quot;C3-Old-GATCAG_S9&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1F-New-ATCACG_S1&quot;,&quot;2F-New-CGATGT_S2&quot;,&quot;3F-New-TTAGGC_S3&quot;)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">files</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">list.files(path</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data&quot;,</span><span class="c0">&nbsp;</span><span class="c2">pattern</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;*_rsem.genes.results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">full.names</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">sample_names</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">gsub(&quot;_rsem.genes.results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;&quot;,</span><span class="c0">&nbsp;</span><span class="c2">basename(files))</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">rsem_list</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">lapply(files,</span><span class="c0">&nbsp;</span><span class="c2">function(file)</span><span class="c0">&nbsp;</span><span class="c2">{</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">read_delim(file,</span><span class="c0">&nbsp;</span><span class="c2">delim</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;\t&quot;,</span><span class="c0">&nbsp;</span><span class="c2">col_names</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">})</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">gene_ids</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rsem_list[[1]]$gene_id</span></p><p class="c4"><span class="c2">count_data</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">do.call(cbind,</span><span class="c0">&nbsp;</span><span class="c2">lapply(rsem_list,</span><span class="c0">&nbsp;</span><span class="c2">function(df)</span><span class="c0">&nbsp;</span><span class="c2">df$expected_count))</span></p><p class="c4"><span class="c2">rownames(count_data)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">gene_ids</span></p><p class="c4"><span class="c2">colnames(count_data)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sample_names</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">count_data</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">round(count_data)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">conditions</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">ifelse(sample_names</span><span class="c0">&nbsp;</span><span class="c2">%in%</span><span class="c0">&nbsp;</span><span class="c2">KO_NRXN1,</span><span class="c0">&nbsp;</span><span class="c2">&quot;KO_NRXN1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;WT_NRXN1&quot;)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">sample_info</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">data.frame(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">sampleName</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_names,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">conditions,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">row.names</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_names</span></p><p class="c4"><span class="c2">)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">dds</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">DESeqDataSetFromMatrix(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">countData</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">count_data,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">colData</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_info,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">design</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">~</span><span class="c0">&nbsp;</span><span class="c2">condition</span></p><p class="c4"><span class="c2">)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">dds</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">DESeq(dds)</span></p><p class="c4"><span class="c2">res</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">results(dds)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">res_df</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">as.data.frame(res)</span></p><p class="c4"><span class="c2">res_df$gene_id</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(res)</span><span class="c5 c0">&nbsp; </span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">countData_df</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">as.data.frame(count_data)</span></p><p class="c4"><span class="c2">countData_df$gene_id</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(countData_df)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">filtered_res_df</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">res_df</span><span class="c0">&nbsp;</span><span class="c2">%&gt;%</span><span class="c0">&nbsp;</span><span class="c2">filter(pvalue</span><span class="c0">&nbsp;</span><span class="c2">&lt;=</span><span class="c0">&nbsp;</span><span class="c2">0.05)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">filtered_res_df$ensembl</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sapply(strsplit(filtered_res_df$gene_id,</span><span class="c0">&nbsp;</span><span class="c2">&quot;_&quot;),</span><span class="c0">&nbsp;</span><span class="c2">function(x)</span><span class="c0">&nbsp;</span><span class="c2">x[1])</span></p><p class="c4"><span class="c2">filtered_res_df$gene_name</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sapply(strsplit(filtered_res_df$gene_id,</span><span class="c0">&nbsp;</span><span class="c2">&quot;_&quot;),</span><span class="c0">&nbsp;</span><span class="c2">function(x)</span><span class="c0">&nbsp;</span><span class="c2">x[2])</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">wb</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">createWorkbook()</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">addWorksheet(wb,</span><span class="c0">&nbsp;</span><span class="c2">&quot;DESeq2_Results&quot;)</span></p><p class="c4"><span class="c2">addWorksheet(wb,</span><span class="c0">&nbsp;</span><span class="c2">&quot;SampleInfo&quot;)</span></p><p class="c4"><span class="c2">addWorksheet(wb,</span><span class="c0">&nbsp;</span><span class="c2">&quot;CountData&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">writeData(wb,</span><span class="c0">&nbsp;</span><span class="c2">sheet</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;DESeq2_Results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">x</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">filtered_res_df)</span></p><p class="c4"><span class="c2">writeData(wb,</span><span class="c0">&nbsp;</span><span class="c2">sheet</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;SampleInfo&quot;,</span><span class="c0">&nbsp;</span><span class="c2">x</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_info)</span></p><p class="c4"><span class="c2">writeData(wb,</span><span class="c0">&nbsp;</span><span class="c2">sheet</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;CountData&quot;,</span><span class="c0">&nbsp;</span><span class="c2">x</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">countData_df)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">saveWorkbook(wb,</span><span class="c0">&nbsp;</span><span class="c2">file</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;WTvKO_NRXN1_DEGsv2.xlsx&quot;,</span><span class="c0">&nbsp;</span><span class="c2">overwrite</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Perform</span><span class="c0">&nbsp;</span><span class="c2">rlog</span><span class="c0">&nbsp;</span><span class="c2">transformation</span></p><p class="c4"><span class="c2">rld</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rlog(dds,</span><span class="c0">&nbsp;</span><span class="c2">blind</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">FALSE)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Extract</span><span class="c0">&nbsp;</span><span class="c2">PCA</span><span class="c0">&nbsp;</span><span class="c2">data</span></p><p class="c4"><span class="c2">pca_data</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">plotPCA(rld,</span><span class="c0">&nbsp;</span><span class="c2">intgroup</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;condition&quot;,</span><span class="c0">&nbsp;</span><span class="c2">returnData</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">percentVar</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">round(100</span><span class="c0">&nbsp;</span><span class="c2">*</span><span class="c0">&nbsp;</span><span class="c2">attr(pca_data,</span><span class="c0">&nbsp;</span><span class="c2">&quot;percentVar&quot;))</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Add</span><span class="c0">&nbsp;</span><span class="c2">SampleID</span><span class="c0">&nbsp;</span><span class="c2">as</span><span class="c0">&nbsp;</span><span class="c2">a</span><span class="c0">&nbsp;</span><span class="c2">label</span></p><p class="c4"><span class="c2">pca_data$SampleID</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(pca_data)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Create</span><span class="c0">&nbsp;</span><span class="c2">PCA</span><span class="c0">&nbsp;</span><span class="c2">plot</span><span class="c0">&nbsp;</span><span class="c2">with</span><span class="c0">&nbsp;</span><span class="c2">labels</span></p><p class="c4"><span class="c2">pca_plot</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">ggplot(pca_data,</span><span class="c0">&nbsp;</span><span class="c2">aes(PC1,</span><span class="c0">&nbsp;</span><span class="c2">PC2,</span><span class="c0">&nbsp;</span><span class="c2">color</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">condition,</span><span class="c0">&nbsp;</span><span class="c2">label</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">SampleID))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">geom_point(size</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">3)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">geom_text(vjust</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">1.5,</span><span class="c0">&nbsp;</span><span class="c2">size</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">3.5)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">xlab(paste0(&quot;PC1:</span><span class="c0">&nbsp;</span><span class="c2">&quot;,</span><span class="c0">&nbsp;</span><span class="c2">percentVar[1],</span><span class="c0">&nbsp;</span><span class="c2">&quot;%</span><span class="c0">&nbsp;</span><span class="c2">variance&quot;))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">ylab(paste0(&quot;PC2:</span><span class="c0">&nbsp;</span><span class="c2">&quot;,</span><span class="c0">&nbsp;</span><span class="c2">percentVar[2],</span><span class="c0">&nbsp;</span><span class="c2">&quot;%</span><span class="c0">&nbsp;</span><span class="c2">variance&quot;))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">coord_fixed()</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">theme_minimal()</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">theme(legend.position</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;top&quot;)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">labs(title</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;PCA</span><span class="c0">&nbsp;</span><span class="c2">Plot&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Display</span><span class="c0">&nbsp;</span><span class="c2">the</span><span class="c0">&nbsp;</span><span class="c2">plot</span></p><p class="c4"><span class="c2">print(pca_plot)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Select</span><span class="c0">&nbsp;</span><span class="c2">the</span><span class="c0">&nbsp;</span><span class="c2">top</span><span class="c0">&nbsp;</span><span class="c2">20</span><span class="c0">&nbsp;</span><span class="c2">genes</span><span class="c0">&nbsp;</span><span class="c2">by</span><span class="c0">&nbsp;</span><span class="c2">p-value</span></p><p class="c4"><span class="c2">top_genes</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">head(filtered_res_df[order(filtered_res_df$pvalue),</span><span class="c0">&nbsp;</span><span class="c2">&quot;gene_id&quot;],</span><span class="c0">&nbsp;</span><span class="c2">20)</span></p><p class="c4"><span class="c2">top_genes_data</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">count_data[rownames(count_data)</span><span class="c0">&nbsp;</span><span class="c2">%in%</span><span class="c0">&nbsp;</span><span class="c2">top_genes,</span><span class="c0">&nbsp;</span><span class="c2">]</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Perform</span><span class="c0">&nbsp;</span><span class="c2">rlog</span><span class="c0">&nbsp;</span><span class="c2">transformation</span><span class="c0">&nbsp;</span><span class="c2">for</span><span class="c0">&nbsp;</span><span class="c2">top</span><span class="c0">&nbsp;</span><span class="c2">genes</span></p><p class="c4"><span class="c2">top_genes_rld</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rlogTransformation(dds[rownames(dds)</span><span class="c0">&nbsp;</span><span class="c2">%in%</span><span class="c0">&nbsp;</span><span class="c2">top_genes,],</span><span class="c0">&nbsp;</span><span class="c2">blind</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">FALSE)</span></p><p class="c4"><span class="c2">top_genes_matrix</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">assay(top_genes_rld)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Create</span><span class="c0">&nbsp;</span><span class="c2">annotation</span><span class="c0">&nbsp;</span><span class="c2">for</span><span class="c0">&nbsp;</span><span class="c2">samples</span></p><p class="c4"><span class="c2">annotation_col</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">data.frame(condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_info$condition)</span></p><p class="c4"><span class="c2">rownames(annotation_col)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(sample_info)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Define</span><span class="c0">&nbsp;</span><span class="c2">colors</span><span class="c0">&nbsp;</span><span class="c2">for</span><span class="c0">&nbsp;</span><span class="c2">the</span><span class="c0">&nbsp;</span><span class="c2">conditions</span></p><p class="c4"><span class="c2">annotation_colors</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">list(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">c(KO_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;red&quot;,</span><span class="c0">&nbsp;</span><span class="c2">WT_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;blue&quot;)</span></p><p class="c4"><span class="c2">)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">png(&quot;heatmap_top20_DEGsV2.png&quot;,</span><span class="c0">&nbsp;</span><span class="c2">width</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">1000,</span><span class="c0">&nbsp;</span><span class="c2">height</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">800)</span></p><p class="c4"><span class="c2">pheatmap(top_genes_matrix,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">cluster_rows</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">cluster_cols</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">annotation_col</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">annotation_col,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">annotation_colors</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">annotation_colors,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">show_rownames</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">show_colnames</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">main</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;Heatmap</span><span class="c0">&nbsp;</span><span class="c2">of</span><span class="c0">&nbsp;</span><span class="c2">Top</span><span class="c0">&nbsp;</span><span class="c2">20</span><span class="c0">&nbsp;</span><span class="c2">DEGs&quot;)</span></p><p class="c4"><span class="c2">dev.off()</span></p><p class="c4"><span class="c2">```</span></p><h3 class="c8" id="h.94c1s9wyubj0"><span class="c18">&#60418;Rsem.isoforms.results</span></h3><p class="c4"><span>&#60419;</span><span class="c2">``{r}</span></p><p class="c4"><span class="c2">setwd(&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data&quot;)</span></p><p class="c4"><span class="c2">library(DESeq2)</span></p><p class="c4"><span class="c2">library(tximport)</span></p><p class="c4"><span class="c2">library(openxlsx)</span></p><p class="c4"><span class="c2">library(readr)</span></p><p class="c4"><span class="c2">library(pheatmap)</span></p><p class="c4"><span class="c2">library(dplyr)</span></p><p class="c4"><span class="c2">library(ggplot2)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">Batch1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;C3141-7_S1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;19N_S2&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;26N_S3&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;26C_S4&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C3141-4_S5&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C2463-19_S6&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;19C_S7&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N9540-19_S8&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3320-4_S9&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N3320-23_S10&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3320-7_S11&quot;,&quot;C3141-23_S12&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4 c7"><span class="c0 c5"></span></p><p class="c4"><span class="c2">Batch2</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;1F-New-ATCACG_S1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;2F-New-CGATGT_S2&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;3F-New-TTAGGC_S3&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1C-New-TGACCA_S4&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;2C-New-ACAGTG_S5&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;3C-New-GCCAAT_S6&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C1-Old-CAGATC_S7&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C2-Old-ACTTGA_S8&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;C3-Old-GATCAG_S9&quot;,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N1-Old-TAGCTT_S10&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N2-Old-GGCTAC_S11&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;N3-Old-CTTGTA_S12&quot;)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">SampleRefID</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">read.csv(&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data/batch1_2fileID.csv&quot;,</span><span class="c0">&nbsp;</span><span class="c2">header</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">F)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">KO_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;N3320-23_S10&quot;,&quot;N3320-4_S9&quot;,&quot;N3320-7_S11&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;26N_S3&quot;,&quot;N9540-19_S8&quot;,&quot;19N_S2&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;N1-Old-TAGCTT_S10&quot;,&quot;N2-Old-GGCTAC_S11&quot;,&quot;N3-Old-CTTGTA_S12&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1C-New-TGACCA_S4&quot;,&quot;2C-New-ACAGTG_S5&quot;,&quot;3C-New-GCCAAT_S6&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">WT_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(&quot;26C_S4&quot;,&quot;C2463-19_S6&quot;,&quot;19C_S7&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C3141-23_S12&quot;,&quot;C3141-4_S5&quot;,&quot;C3141-7_S1&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;C1-Old-CAGATC_S7&quot;,&quot;C2-Old-ACTTGA_S8&quot;,&quot;C3-Old-GATCAG_S9&quot;,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2">&quot;1F-New-ATCACG_S1&quot;,&quot;2F-New-CGATGT_S2&quot;,&quot;3F-New-TTAGGC_S3&quot;)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">files</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">list.files(path</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;/work/pi_cpak_umass_edu/Hinderhofer_M/DESeq2/bulkRNA_Data&quot;,</span><span class="c0">&nbsp;</span><span class="c2">pattern</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;*_rsem.isoforms.results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">full.names</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">sample_names</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">gsub(&quot;_rsem.isoforms.results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">&quot;&quot;,</span><span class="c0">&nbsp;</span><span class="c2">basename(files))</span></p><p class="c4"><span class="c2">names(files)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sample_names</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">condition_labels</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(rep(&quot;KO_NRXN1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">length(KO_NRXN1)),</span><span class="c0">&nbsp;</span><span class="c2">rep(&quot;WT_NRXN1&quot;,</span><span class="c0">&nbsp;</span><span class="c2">length(WT_NRXN1)))</span></p><p class="c4"><span class="c2">names(condition_labels)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">c(KO_NRXN1,</span><span class="c0">&nbsp;</span><span class="c2">WT_NRXN1)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">conditions</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">condition_labels[sample_names]</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">sample_info</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">data.frame(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">sampleNames</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_names,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">conditions,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">row.names</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_names</span></p><p class="c4"><span class="c2">)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">txi</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">tximport(files,</span><span class="c0">&nbsp;</span><span class="c2">type</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;rsem&quot;,</span><span class="c0">&nbsp;</span><span class="c2">txIn</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c0">&nbsp;</span><span class="c2">txOut</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">dds</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">DESeqDataSetFromTximport(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">txi,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">colData</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">sample_info,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">design</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">~</span><span class="c0">&nbsp;</span><span class="c2">condition</span></p><p class="c4"><span class="c2">)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">dds</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">DESeq(dds)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">res</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">results(dds)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">res_df</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">as.data.frame(res)</span></p><p class="c4"><span class="c2">res_df$transcript_id</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(res)</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">filtered_res_df</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">res_df</span><span class="c0">&nbsp;</span><span class="c2">%&gt;%</span><span class="c0">&nbsp;</span><span class="c2">filter(pvalue</span><span class="c0">&nbsp;</span><span class="c2">&lt;=</span><span class="c0">&nbsp;</span><span class="c2">0.05)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">filtered_res_df$ensembl</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sapply(strsplit(filtered_res_df$transcript_id,</span><span class="c0">&nbsp;</span><span class="c2">&quot;_&quot;),</span><span class="c0">&nbsp;</span><span class="c2">function(x)</span><span class="c0">&nbsp;</span><span class="c2">x[1])</span></p><p class="c4"><span class="c2">filtered_res_df$isoform</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sapply(strsplit(filtered_res_df$transcript_id,</span><span class="c0">&nbsp;</span><span class="c2">&quot;_&quot;),</span><span class="c0">&nbsp;</span><span class="c2">function(x)</span><span class="c0">&nbsp;</span><span class="c2">x[2])</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">filtered_res_df$gene</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sapply(filtered_res_df$transcript_id,</span><span class="c0">&nbsp;</span><span class="c2">function(x)</span><span class="c0">&nbsp;</span><span class="c2">{</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">matches</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">regmatches(x,</span><span class="c0">&nbsp;</span><span class="c2">regexpr(&quot;_(.*?)-&quot;,</span><span class="c0">&nbsp;</span><span class="c2">x))</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">if</span><span class="c0">&nbsp;</span><span class="c2">(length(matches)</span><span class="c0">&nbsp;</span><span class="c2">&gt;</span><span class="c0">&nbsp;</span><span class="c2">0)</span><span class="c0">&nbsp;</span><span class="c2">{</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">return(substring(matches,</span><span class="c0">&nbsp;</span><span class="c2">2,</span><span class="c0">&nbsp;</span><span class="c2">nchar(matches)</span><span class="c0">&nbsp;</span><span class="c2">-</span><span class="c0">&nbsp;</span><span class="c2">1))</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">}</span><span class="c0">&nbsp;</span><span class="c2">else</span><span class="c0">&nbsp;</span><span class="c2">{</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">return(NA)</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">}</span></p><p class="c4"><span class="c2">})</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">wb</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">createWorkbook()</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">addWorksheet(wb,</span><span class="c0">&nbsp;</span><span class="c2">&quot;DESeq2_Results&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">writeData(wb,</span><span class="c0">&nbsp;</span><span class="c2">sheet</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;DESeq2_Results&quot;,</span><span class="c0">&nbsp;</span><span class="c2">x</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">filtered_res_df)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">saveWorkbook(wb,</span><span class="c0">&nbsp;</span><span class="c2">file</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;WTvKO_NRXN1_Isoforms_tximport.xlsx&quot;,</span><span class="c0">&nbsp;</span><span class="c2">overwrite</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">rld</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rlog(dds,</span><span class="c0">&nbsp;</span><span class="c2">blind</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">FALSE)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">top_transcripts</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">head(filtered_res_df[order(filtered_res_df$pvalue),</span><span class="c0">&nbsp;</span><span class="c2">&quot;transcript_id&quot;],</span><span class="c0">&nbsp;</span><span class="c2">20)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">top_transcripts</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">top_transcripts[top_transcripts</span><span class="c0">&nbsp;</span><span class="c2">%in%</span><span class="c0">&nbsp;</span><span class="c2">rownames(assay(rld))]</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">top_transcripts_matrix</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">assay(rld)[top_transcripts,</span><span class="c0">&nbsp;</span><span class="c2">]</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">ordered_sample_info</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">sample_info[order(sample_info$condition),</span><span class="c0">&nbsp;</span><span class="c2">,</span><span class="c0">&nbsp;</span><span class="c2">drop</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">FALSE]</span></p><p class="c4"><span class="c2">ordered_top_transcripts_matrix</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">top_transcripts_matrix[,</span><span class="c0">&nbsp;</span><span class="c2">rownames(ordered_sample_info)]</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">annotation_colors</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">list(</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; </span><span class="c2">condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">c(KO_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;red&quot;,</span><span class="c0">&nbsp;</span><span class="c2">WT_NRXN1</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;blue&quot;)</span></p><p class="c4"><span class="c2">)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">annotation_col</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">data.frame(condition</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">ordered_sample_info$condition)</span></p><p class="c4"><span class="c2">rownames(annotation_col)</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(ordered_sample_info)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">png(&quot;heatmap_top20_Isoforms_tximport.png&quot;,</span><span class="c0">&nbsp;</span><span class="c2">width</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">1000,</span><span class="c0">&nbsp;</span><span class="c2">height</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">800)</span></p><p class="c4"><span class="c2">pheatmap(ordered_top_transcripts_matrix,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">cluster_rows</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">cluster_cols</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">FALSE,</span><span class="c0">&nbsp;</span><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Turn</span><span class="c0">&nbsp;</span><span class="c2">off</span><span class="c0">&nbsp;</span><span class="c2">column</span><span class="c0">&nbsp;</span><span class="c2">clustering</span><span class="c0">&nbsp;</span><span class="c2">to</span><span class="c0">&nbsp;</span><span class="c2">keep</span><span class="c0">&nbsp;</span><span class="c2">order</span><span class="c0">&nbsp;</span><span class="c2">by</span><span class="c0">&nbsp;</span><span class="c2">condition</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">annotation_col</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">annotation_col,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">annotation_colors</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">annotation_colors,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">show_rownames</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span><span class="c5 c0">&nbsp;</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">show_colnames</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE,</span></p><p class="c4"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">main</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;Heatmap</span><span class="c0">&nbsp;</span><span class="c2">of</span><span class="c0">&nbsp;</span><span class="c2">Top</span><span class="c0">&nbsp;</span><span class="c2">20</span><span class="c0">&nbsp;</span><span class="c2">Differentially</span><span class="c0">&nbsp;</span><span class="c2">Expressed</span><span class="c0">&nbsp;</span><span class="c2">Transcripts&quot;)</span></p><p class="c4"><span class="c2">dev.off()</span></p><p class="c4"><span class="c2">```</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">```{r}</span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Extract</span><span class="c0">&nbsp;</span><span class="c2">PCA</span><span class="c0">&nbsp;</span><span class="c2">data</span></p><p class="c4"><span class="c2">pca_data</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">plotPCA(rld,</span><span class="c0">&nbsp;</span><span class="c2">intgroup</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;condition&quot;,</span><span class="c0">&nbsp;</span><span class="c2">returnData</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">TRUE)</span></p><p class="c4"><span class="c2">percentVar</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">round(100</span><span class="c0">&nbsp;</span><span class="c2">*</span><span class="c0">&nbsp;</span><span class="c2">attr(pca_data,</span><span class="c0">&nbsp;</span><span class="c2">&quot;percentVar&quot;))</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Add</span><span class="c0">&nbsp;</span><span class="c2">SampleID</span><span class="c0">&nbsp;</span><span class="c2">as</span><span class="c0">&nbsp;</span><span class="c2">a</span><span class="c0">&nbsp;</span><span class="c2">label</span></p><p class="c4"><span class="c2">pca_data$SampleID</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">rownames(pca_data)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Create</span><span class="c0">&nbsp;</span><span class="c2">PCA</span><span class="c0">&nbsp;</span><span class="c2">plot</span><span class="c0">&nbsp;</span><span class="c2">with</span><span class="c0">&nbsp;</span><span class="c2">labels</span></p><p class="c4"><span class="c2">pca_plot</span><span class="c0">&nbsp;</span><span class="c2">&lt;-</span><span class="c0">&nbsp;</span><span class="c2">ggplot(pca_data,</span><span class="c0">&nbsp;</span><span class="c2">aes(PC1,</span><span class="c0">&nbsp;</span><span class="c2">PC2,</span><span class="c0">&nbsp;</span><span class="c2">color</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">condition,</span><span class="c0">&nbsp;</span><span class="c2">label</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">SampleID))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">geom_point(size</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">3)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">geom_text(vjust</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">1.5,</span><span class="c0">&nbsp;</span><span class="c2">size</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">3.5)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">xlab(paste0(&quot;PC1:</span><span class="c0">&nbsp;</span><span class="c2">&quot;,</span><span class="c0">&nbsp;</span><span class="c2">percentVar[1],</span><span class="c0">&nbsp;</span><span class="c2">&quot;%</span><span class="c0">&nbsp;</span><span class="c2">variance&quot;))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">ylab(paste0(&quot;PC2:</span><span class="c0">&nbsp;</span><span class="c2">&quot;,</span><span class="c0">&nbsp;</span><span class="c2">percentVar[2],</span><span class="c0">&nbsp;</span><span class="c2">&quot;%</span><span class="c0">&nbsp;</span><span class="c2">variance&quot;))</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">coord_fixed()</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">theme_minimal()</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">theme(legend.position</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;top&quot;)</span><span class="c0">&nbsp;</span><span class="c2">+</span></p><p class="c4"><span class="c0">&nbsp; </span><span class="c2">labs(title</span><span class="c0">&nbsp;</span><span class="c2">=</span><span class="c0">&nbsp;</span><span class="c2">&quot;PCA</span><span class="c0">&nbsp;</span><span class="c2">Plot&quot;)</span></p><p class="c4 c7"><span class="c5 c0"></span></p><p class="c4"><span class="c2">#</span><span class="c0">&nbsp;</span><span class="c2">Display</span><span class="c0">&nbsp;</span><span class="c2">the</span><span class="c0">&nbsp;</span><span class="c2">plot</span></p><p class="c4"><span class="c2">print(pca_plot)</span></p><p class="c4"><span class="c2">```</span></p><p class="c4"><span>&#60418;</span></p><h2 class="c9" id="h.4nyfkhsxc088"><span class="c3">Majiq</span></h2><h3 class="c8" id="h.nqihtsyr5aa8"><span class="c5 c14">Configuration File</span></h3><p class="c4"><span>&#60419;</span><span class="c12 c11 c2">[info]</span></p><p class="c4"><span class="c12 c11 c2">bamdirs = /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-23_S10/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-4_S9/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-7_S11/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/26N_S3/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N9540-19_S8/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/19N_S2/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N1-Old-TAGCTT_S10/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N2-Old-GGCTAC_S11/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N3-Old-CTTGTA_S12/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/1C-New-TGACCA_S4/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/2C-New-ACAGTG_S5/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/3C-New-GCCAAT_S6/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/26C_S4/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C2463-19_S6/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/19C_S7/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-23_S12/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-4_S5/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-7_S1/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C1-Old-CAGATC_S7/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C2-Old-ACTTGA_S8/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C3-Old-GATCAG_S9/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/1F-New-ATCACG_S1/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/2F-New-CGATGT_S2/Results,/work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/3F-New-TTAGGC_S3/Results</span></p><p class="c4"><span class="c12 c11 c2">genome = hg38</span></p><p class="c4"><span class="c12 c11 c2">genome_path = /work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Genome</span></p><p class="c4 c7"><span class="c12 c11 c2"></span></p><p class="c4"><span class="c12 c11 c2">[experiments]</span></p><p class="c4"><span class="c12 c11 c2">KO_NRXN1 = N3320-23_S10_Aligned.sortedByCoord.out,N3320-4_S9_Aligned.sortedByCoord.out,N3320-7_S11_Aligned.sortedByCoord.out,26N_S3_Aligned.sortedByCoord.out,N9540-19_S8_Aligned.sortedByCoord.out,19N_S2_Aligned.sortedByCoord.out,N1-Old-TAGCTT_S10_Aligned.sortedByCoord.out,N2-Old-GGCTAC_S11_Aligned.sortedByCoord.out,N3-Old-CTTGTA_S12_Aligned.sortedByCoord.out,1C-New-TGACCA_S4_Aligned.sortedByCoord.out,2C-New-ACAGTG_S5_Aligned.sortedByCoord.out,3C-New-GCCAAT_S6_Aligned.sortedByCoord.out</span></p><p class="c4 c7"><span class="c12 c11 c2"></span></p><p class="c4"><span class="c12 c11 c2">WT_NRXN1 = 26C_S4_Aligned.sortedByCoord.out,C2463-19_S6_Aligned.sortedByCoord.out,19C_S7_Aligned.sortedByCoord.out,C3141-23_S12_Aligned.sortedByCoord.out,C3141-4_S5_Aligned.sortedByCoord.out,C3141-7_S1_Aligned.sortedByCoord.out,C1-Old-CAGATC_S7_Aligned.sortedByCoord.out,C2-Old-ACTTGA_S8_Aligned.sortedByCoord.out,C3-Old-GATCAG_S9_Aligned.sortedByCoord.out,1F-New-ATCACG_S1_Aligned.sortedByCoord.out,2F-New-CGATGT_S2_Aligned.sortedByCoord.out,3F-New-TTAGGC_S3_Aligned.sortedByCoord.out</span></p><h3 class="c8" id="h.xw204plg9s6"><span class="c5 c14">&#60418;Majiq Builder</span></h3><ul class="c17 lst-kix_vzlahrcf8wbb-0 start"><li class="c1 li-bullet-0"><span>module load </span><span class="c3">miniconda/22.11.1-1</span></li><li class="c1 li-bullet-0"><span class="c3">conda activate majiq_env</span></li><li class="c1 li-bullet-0"><span class="c2">cd</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/majiq_academic</span></li></ul><p class="c4 c7"><span class="c3"></span></p><p class="c16"><span>&#60419;</span><span class="c11 c2">majiq</span><span class="c11 c13">&nbsp;</span><span class="c11 c2">build</span><span class="c11 c13">&nbsp;</span><span class="c11 c2">-c</span><span class="c11 c13">&nbsp;</span><span class="c11 c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/majiq_academic/majiq_config.ini /work/pi_cpak_umass_edu/Hinderhofer_M/Genome/Homo_sapiens.GRCh38.112.gff3 -o</span><span class="c11 c13">&nbsp;</span><span class="c11 c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq -j</span><span class="c11 c13">&nbsp;</span><span class="c12 c11 c2">14</span></p><h3 class="c8" id="h.p2snx8tpz0yz"><span class="c5 c14">&#60418;DeltaPSI</span></h3><p class="c4"><span>&#60419;</span><span class="c2">majiq</span><span>&nbsp;</span><span class="c2">deltapsi</span><span>&nbsp;</span><span class="c2">-o</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/deltapsi_output</span><span>&nbsp;</span><span class="c2">-n</span><span>&nbsp;</span><span class="c2">KO_NRXN1</span><span>&nbsp;</span><span class="c2">WT_NRXN1</span><span>&nbsp;</span><span class="c2">-grp1</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N3320-23_S10_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N3320-4_S9_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N3320-7_S11_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/26N_S3_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N9540-19_S8_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/19N_S2_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N1-Old-TAGCTT_S10_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N2-Old-GGCTAC_S11_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/N3-Old-CTTGTA_S12_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/1C-New-TGACCA_S4_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/2C-New-ACAGTG_S5_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/3C-New-GCCAAT_S6_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">-grp2</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/26C_S4_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C2463-19_S6_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/19C_S7_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C3141-23_S12_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C3141-4_S5_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C3141-7_S1_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C1-Old-CAGATC_S7_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C2-Old-ACTTGA_S8_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/C3-Old-GATCAG_S9_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/1F-New-ATCACG_S1_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/2F-New-CGATGT_S2_Aligned.sortedByCoord.out.majiq</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/3F-New-TTAGGC_S3_Aligned.sortedByCoord.out.majiq</span></p><p class="c4 c7"><span class="c3"></span></p><h3 class="c8" id="h.k08309f9w2ey"><span class="c18">&#60418;Heterogen</span></h3><p class="c4"><span>&#60419;</span><span class="c12 c11 c2">majiq heterogen -o /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/heterogen \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; -n KO_NRXN1 WT_NRXN1 \</span></p><p class="c4"><span class="c11 c2 c12">&nbsp; &nbsp; -grp1 /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N3320-23_S10_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N3320-4_S9_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N3320-7_S11_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/26N_S3_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N9540-19_S8_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/19N_S2_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N1-Old-TAGCTT_S10_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N2-Old-GGCTAC_S11_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/N3-Old-CTTGTA_S12_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/1C-New-TGACCA_S4_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/2C-New-ACAGTG_S5_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/3C-New-GCCAAT_S6_Aligned.sortedByCoord.out.majiq \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; -grp2 /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/26C_S4_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C2463-19_S6_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/19C_S7_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C3141-23_S12_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C3141-4_S5_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C3141-7_S1_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C1-Old-CAGATC_S7_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C2-Old-ACTTGA_S8_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/C3-Old-GATCAG_S9_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/1F-New-ATCACG_S1_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/2F-New-CGATGT_S2_Aligned.sortedByCoord.out.majiq /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/Build_output/3F-New-TTAGGC_S3_Aligned.sortedByCoord.out.majiq</span></p><h3 class="c8" id="h.koc25rdxhpre"><span class="c5 c14">&#60418;Modulize </span></h3><p class="c4"><span>&#60419;</span><span class="c5 c2">voila modulize -d /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/voila_output_Het -j 14 /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/splicegraph.sql /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/heterogen/KO_NRXN1-WT_NRXN1.het.voila</span></p><h3 class="c8" id="h.sqosm7rrrnhm"><span class="c2">&#60418;</span><span class="c18">Create TSV</span></h3><p class="c4"><span>&#60419;</span><span class="c5 c2">voila tsv \</span></p><p class="c4"><span class="c5 c2">&nbsp; &nbsp; /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/splicegraph.sql \</span></p><p class="c4"><span class="c5 c2">&nbsp; &nbsp; /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/heterogen/KO_NRXN1-WT_NRXN1.het.voila \</span></p><p class="c4"><span class="c5 c2">&nbsp; &nbsp; --show-all \</span></p><p class="c4"><span class="c5 c2">&nbsp; &nbsp; -f /work/pi_cpak_umass_edu/Hinderhofer_M/Majiq/heterogen/het.tsv</span></p><p class="c4"><span class="c3">&#60418;</span></p><h3 class="c8" id="h.eiix2km30qw6"><span class="c18">Visualization</span></h3><p class="c4"><span>&#60419;</span><span class="c5 c2">ssh unity</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c2">module</span><span>&nbsp;</span><span class="c2">load</span><span>&nbsp;</span><span class="c2">miniconda/22.11.1-1</span></p><p class="c4"><span class="c2">conda</span><span>&nbsp;</span><span class="c2">activate</span><span>&nbsp;</span><span class="c2">majiq_env</span></p><p class="c4"><span class="c2">cd</span><span>&nbsp;</span><span class="c5 c2">/work/pi_cpak_umass_edu/Hinderhofer_M/Majiq</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c2">voila view </span><span class="c12 c11 c2">heterogen</span></p><p class="c4"><span class="c3">&#60418;</span></p><p class="c4"><span class="c3">New Terminal </span></p><p class="c4"><span>&#60419;</span><span class="c11 c2">ssh</span><span class="c11">&nbsp;</span><span class="c11 c2">-L</span><span class="c11">&nbsp;</span><span class="c11 c2 c26">40183</span><span class="c11 c2">:localhost:</span><span class="c11 c2 c26">40183</span><span class="c11">&nbsp;</span><span class="c2 c11">unity</span></p><p class="c4"><span class="c3">&#60418;</span></p><p class="c4"><span class="c3">Go to http://localhost:XXXXX</span></p><h2 class="c9" id="h.pqlmyejzazrb"><span class="c3">GGSashimi</span></h2><ul class="c17 lst-kix_l58p16ed4y8z-0 start"><li class="c1 li-bullet-0"><span>wget </span><span class="c24"><a class="c25" href="https://www.google.com/url?q=https://raw.githubusercontent.com/guigolab/ggsashimi/master/ggsashimi.py&amp;sa=D&amp;source=editors&amp;ust=1728328931981258&amp;usg=AOvVaw0gsDDmYkAXTuIaMWN-vefa">https://raw.githubusercontent.com/guigolab/ggsashimi/master/ggsashimi.py</a></span></li><li class="c1 li-bullet-0"><span class="c3">chmod u+x ggsashimi.py</span></li></ul><p class="c4 c7"><span class="c3"></span></p><ul class="c17 lst-kix_l58p16ed4y8z-0"><li class="c1 li-bullet-0"><span class="c2">cd</span><span>&nbsp;</span><span class="c2">/work/pi_cpak_umass_edu/Hinderhofer_M/ggsashimi</span></li><li class="c1 li-bullet-0"><span class="c3">module load openblas/0.3.18</span></li><li class="c1 li-bullet-0"><span class="c3">module load py-pysam/0.18.0+py3.8.12-zvjy3p3</span></li><li class="c1 li-bullet-0"><span class="c3">Need to install ggplot2 -&gt; manually install -&gt; R</span></li></ul><ul class="c17 lst-kix_l58p16ed4y8z-1 start"><li class="c4 c23 li-bullet-0"><span class="c3">install.packages(&quot;MASS_7.3-54.tar.gz&quot;, repos = NULL, type = &quot;source&quot;)</span></li><li class="c4 c23 li-bullet-0"><span class="c3">install.packages(&quot;Matrix_1.2-18.tar.gz&quot;, repos = NULL, type = &quot;source&quot;)</span></li><li class="c4 c23 li-bullet-0"><span class="c3">install.packages(&quot;mgcv_1.8-33.tar.gz&quot;, repos = NULL, type = &quot;source&quot;)</span></li><li class="c4 c23 li-bullet-0"><span class="c3">install.packages(&quot;ggplot2_3.3.5.tar.gz&quot;, repos = NULL, type = &quot;source&quot;)</span></li></ul><h3 class="c8" id="h.wc219klefc7o"><span class="c5 c14">Config File</span></h3><p class="c4"><span>&#60419;</span><span class="c5 c2">[bam_files]</span></p><p class="c4"><span class="c5 c2">KO_N3320_23_S10: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-23_S10/Results/N3320-23_S10_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N3320_4_S9: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-4_S9/Results/N3320-4_S9_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N3320_7_S11: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N3320-7_S11/Results/N3320-7_S11_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_26N_S3: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/26N_S3/Results/26N_S3_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N9540_19_S8: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/N9540-19_S8/Results/N9540-19_S8_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_19N_S2: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/19N_S2/Results/19N_S2_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N1_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N1-Old-TAGCTT_S10/Results/N1-Old-TAGCTT_S10_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N2_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N2-Old-GGCTAC_S11/Results/N2-Old-GGCTAC_S11_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_N3_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/N3-Old-CTTGTA_S12/Results/N3-Old-CTTGTA_S12_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_1C_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/1C-New-TGACCA_S4/Results/1C-New-TGACCA_S4_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_2C_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/2C-New-ACAGTG_S5/Results/2C-New-ACAGTG_S5_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">KO_3C_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/3C-New-GCCAAT_S6/Results/3C-New-GCCAAT_S6_Aligned.sortedByCoord.out.bam</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">WT_26C_S4: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/26C_S4/Results/26C_S4_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C2463_19_S6: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C2463-19_S6/Results/C2463-19_S6_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_19C_S7: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/19C_S7/Results/19C_S7_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C3141_23_S12: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-23_S12/Results/C3141-23_S12_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C3141_4_S5: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-4_S5/Results/C3141-4_S5_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C3141_7_S1: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch1/C3141-7_S1/Results/C3141-7_S1_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C1_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C1-Old-CAGATC_S7/Results/C1-Old-CAGATC_S7_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C2_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C2-Old-ACTTGA_S8/Results/C2-Old-ACTTGA_S8_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_C3_Old: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/C3-Old-GATCAG_S9/Results/C3-Old-GATCAG_S9_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_1F_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/1F-New-ATCACG_S1/Results/1F-New-ATCACG_S1_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_2F_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/2F-New-CGATGT_S2/Results/2F-New-CGATGT_S2_Aligned.sortedByCoord.out.bam</span></p><p class="c4"><span class="c5 c2">WT_3F_New: /work/pi_cpak_umass_edu/Hinderhofer_M/fastq_batch2/3F-New-TTAGGC_S3/Results/3F-New-TTAGGC_S3_Aligned.sortedByCoord.out.bam</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">[labels]</span></p><p class="c4"><span class="c5 c2">KO_N3320_23_S10: KO</span></p><p class="c4"><span class="c5 c2">KO_N3320_4_S9: KO</span></p><p class="c4"><span class="c5 c2">KO_N3320_7_S11: KO</span></p><p class="c4"><span class="c5 c2">KO_26N_S3: KO</span></p><p class="c4"><span class="c5 c2">KO_N9540_19_S8: KO</span></p><p class="c4"><span class="c5 c2">KO_19N_S2: KO</span></p><p class="c4"><span class="c5 c2">KO_N1_Old: KO</span></p><p class="c4"><span class="c5 c2">KO_N2_Old: KO</span></p><p class="c4"><span class="c5 c2">KO_N3_Old: KO</span></p><p class="c4"><span class="c5 c2">KO_1C_New: KO</span></p><p class="c4"><span class="c5 c2">KO_2C_New: KO</span></p><p class="c4"><span class="c5 c2">KO_3C_New: KO</span></p><p class="c4 c7"><span class="c5 c2"></span></p><p class="c4"><span class="c5 c2">WT_26C_S4: WT</span></p><p class="c4"><span class="c5 c2">WT_C2463_19_S6: WT</span></p><p class="c4"><span class="c5 c2">WT_19C_S7: WT</span></p><p class="c4"><span class="c5 c2">WT_C3141_23_S12: WT</span></p><p class="c4"><span class="c5 c2">WT_C3141_4_S5: WT</span></p><p class="c4"><span class="c5 c2">WT_C3141_7_S1: WT</span></p><p class="c4"><span class="c5 c2">WT_C1_Old: WT</span></p><p class="c4"><span class="c5 c2">WT_C2_Old: WT</span></p><p class="c4"><span class="c5 c2">WT_C3_Old: WT</span></p><p class="c4"><span class="c5 c2">WT_1F_New: WT</span></p><p class="c4"><span class="c5 c2">WT_2F_New: WT</span></p><p class="c4"><span class="c5 c2">WT_3F_New: WT</span></p><h3 class="c8" id="h.uac6pdeygz6x"><span>&#60418;</span><span class="c18">Run File </span></h3><p class="c4"><span>&#60419;</span><span class="c12 c11 c2">python ggsashimi.py -b ggsashimi_config.tsv \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -c 14:73275107-73458617 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -g /work/pi_cpak_umass_edu/Hinderhofer_M/ggsashimi/Homo_sapiens.GRCh38.111.gtf \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -M 5 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -C 2 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -A median \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --width 10 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --shrink \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --fix-y-scale \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --ann-height 4 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --height 2 \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -o NUMB_LSV_sashimi_plot_whole \</span></p><p class="c4"><span class="c12 c11 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -O 3</span></p><p class="c4"><span class="c3">&#60418;</span></p><h2 class="c9" id="h.52vi7rrobxhw"><span class="c6">Moccasin</span></h2><h3 class="c8" id="h.i5mtggfq8tiw"><span class="c10">Install</span></h3><p class="c4"><span class="c3">cd /work/pi_cpak_umass_edu/Hinderhofer_M/bulkRNA_Analysis/Majiq/Moccasin</span></p><p class="c4"><span class="c3">module load miniconda/22.11.1-1</span></p><p class="c4"><span class="c3">conda activate majiq_env</span></p><p class="c4"><span>git clone </span><span class="c24"><a class="c25" href="https://www.google.com/url?q=https://bitbucket.org/biociphers/moccasin.git&amp;sa=D&amp;source=editors&amp;ust=1728328931988177&amp;usg=AOvVaw3Mw1-L_hHDQMyb0E2ObEk0">https://bitbucket.org/biociphers/moccasin.git</a></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4"><span class="c3">STUCK HERE FOR NOW </span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p><p class="c4 c7"><span class="c3"></span></p></body></html>